---
import BlogLayout from '../../../layouts/BlogLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog-en')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

---
<BlogLayout title="Blog" description="Content on pipeline, sales, and revenue ops for B2B SaaS.">
  <section class="blog-list container">
    <h1 class="blog-list-title">Blog</h1>
    {posts.length === 0 ? (
      <p class="empty-state">No posts yet. Check back soon.</p>
    ) : (
      <ul class="post-list">
        {posts.map((post) => {
          const desc = post.data.description || post.data.excerpt;
          return (
            <li class="post-item">
              <a href={`/en/blog/${post.slug.replace(/^\d+-/, '')}`} class="post-link">
                <h2 class="post-title">{post.data.title}</h2>
                <time class="post-date" datetime={post.data.pubDate.toISOString()}>
                  {post.data.pubDate.toLocaleDateString('en-US', { day: '2-digit', month: 'short', year: 'numeric' })}
                </time>
                {desc && <p class="post-desc">{desc}</p>}
              </a>
            </li>
          );
        })}
      </ul>
    )}
  </section>
</BlogLayout>

<style>
  .blog-list {
    padding-top: 60px;
    padding-bottom: 80px;
  }
  .blog-list-title {
    font-family: var(--sans);
    font-size: 40px;
    font-weight: 800;
    letter-spacing: -0.03em;
    color: var(--black);
    margin-bottom: 40px;
  }
  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .post-item {
    border-bottom: 1px solid var(--line);
  }
  .post-link {
    display: block;
    padding: 24px 0;
    transition: background 0.2s;
  }
  .post-link:hover {
    background: var(--off);
  }
  .post-title {
    font-family: var(--sans);
    font-size: 20px;
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--black);
    line-height: 1.3;
  }
  .post-date {
    display: block;
    font-family: var(--sans);
    font-size: 13px;
    color: var(--muted);
    margin-top: 6px;
  }
  .post-desc {
    font-family: var(--serif);
    font-size: 15px;
    line-height: 1.6;
    color: var(--text-med);
    margin-top: 8px;
  }
  .empty-state {
    font-family: var(--serif);
    font-size: 17px;
    color: var(--muted);
    padding: 40px 0;
  }
</style>
